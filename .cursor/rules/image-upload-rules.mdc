# 图片上传组件和功能指南

本项目使用自定义组件和工具函数处理图片上传、预览和删除功能，特别是在客户管理模块中。

## 图片上传组件

项目提供了两种图片上传组件：

### 1. ImageUpload 组件

- 用于单张图片的上传和预览
- 支持图片的标签和描述
- 提供图片预览和删除功能
- 优化了图片载入错误处理
- 集成了上传前校验功能

### 2. MultiImageUpload 组件

- 支持多张图片的批量上传
- 每张图片可以添加标签
- 使用 `Record<string, ImageType>` 结构存储图片数据
- 提供批量预览和删除功能
- 优化了多图片布局和排列

## 图片存储结构

图片数据使用以下结构：

```typescript
interface ImageType {
  fileName?: string // MinIO中的文件名
  url?: string     // 完整的访问URL
}
```

不同类型的图片字段使用不同的数据结构：

- 固定类别的图片（如身份证正反面）：使用对象结构，键为固定的标识符
- 不固定数量的图片（如补充资料）：使用 `Record<string, ImageType>` 动态存储

## 图片上传工具函数

`src/utils/upload.ts` 提供了以下关键功能：

- `uploadFile`: 封装了图片上传到 MinIO 的逻辑
- `deleteFile`: 提供删除已上传文件的功能
- `buildImageUrl`: 构建完整的图片访问URL

## 最佳实践

- 使用 onSuccess 回调处理上传成功后的逻辑，如自动保存表单
- 处理表单取消时清理已上传但未保存的图片
- 在组件中跟踪已上传的图片，便于后续操作
- 使用图片预览功能提供更好的用户体验
- 显示图片上传和处理过程的加载状态
- 处理图片加载错误，显示占位图像
